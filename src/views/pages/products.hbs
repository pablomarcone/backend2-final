<div class="container mx-auto px-4 max-w-6xl">
    <h1 class="text-3xl font-bold text-gray-800 mb-8 text-center">Lista de Productos con Paginación y Filtros</h1>


    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
        <h2 class="text-lg font-semibold text-gray-800 mb-4">Filtros y Opciones</h2>
        <form id="filters-form" class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                <div>
                    <label for="limit" class="block text-sm font-medium text-gray-700 mb-1">
                        Productos por página
                    </label>
                    <select id="limit" name="limit"
                        class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="5" {{#if (eq currentLimit 5)}}selected{{/if}}>5</option>
                        <option value="10" {{#if (eq currentLimit 10)}}selected{{/if}}>10</option>
                        <option value="20" {{#if (eq currentLimit 20)}}selected{{/if}}>20</option>
                        <option value="50" {{#if (eq currentLimit 50)}}selected{{/if}}>50</option>
                    </select>
                </div>

                <div>
                    <label for="sort" class="block text-sm font-medium text-gray-700 mb-1">
                        Ordenar por precio
                    </label>
                    <select id="sort" name="sort"
                        class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="" {{#unless currentSort}}selected{{/unless}}>Sin ordenar</option>
                        <option value="asc" {{#if (eq currentSort 'asc' )}}selected{{/if}}>Menor a mayor</option>
                        <option value="desc" {{#if (eq currentSort 'desc' )}}selected{{/if}}>Mayor a menor</option>
                    </select>
                </div>

                <div>
                    <label for="status" class="block text-sm font-medium text-gray-700 mb-1">
                        Estado
                    </label>
                    <select id="status" name="status"
                        class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="" {{#unless currentStatus}}selected{{/unless}}>Todos</option>
                        <option value="true" {{#if (eq currentStatus 'true' )}}selected{{/if}}>Activos</option>
                        <option value="false" {{#if (eq currentStatus 'false' )}}selected{{/if}}>Inactivos</option>
                    </select>
                </div>

                <div>
                    <label for="category" class="block text-sm font-medium text-gray-700 mb-1">
                        Categoría
                    </label>
                    <select id="category" name="category"
                        class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="" {{#unless currentCategory}}selected{{/unless}}>Todas las categorías</option>
                        {{#each availableCategories}}
                        <option value="{{this}}" {{#if (eq this ../currentCategory)}}selected{{/if}}>{{this}}</option>
                        {{/each}}
                    </select>
                </div>

                <div class="flex flex-col space-y-2">
                    <button type="submit"
                        class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 font-medium">
                        Aplicar Filtros
                    </button>
                    <button type="button" id="clear-filters"
                        class="bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 font-medium">
                        Limpiar
                    </button>
                </div>
            </div>
        </form>
    </div>


    <div id="cart-active" class="bg-white rounded-lg shadow-md p-6 mb-6" style="display: none;">
        <div class="flex items-start justify-between mb-4">
            <div>
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Carrito de Compras</h2>
                <p class="text-gray-600">Tienes productos en tu carrito</p>
            </div>
            <div class="text-right">
                <p class="text-sm text-gray-500 mb-1">ID del Carrito</p>
                <p class="text-sm font-mono text-gray-700" id="cart-id-display"></p>
            </div>
        </div>

        <div class="border-t border-gray-200 pt-4">
            <div class="flex justify-between items-center">
                <div class="space-x-3">
                    <button class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 font-medium"
                        id="view-cart-btn">
                        Ver Carrito Completo
                    </button>
                    <button class="bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 font-medium"
                        id="reset-cart-btn">
                        Reiniciar
                    </button>
                </div>
                <div class="text-right">
                    <p class="text-sm text-gray-500">Continúa agregando productos</p>
                </div>
            </div>
        </div>
    </div>

    <div id="cart-empty" class="bg-white rounded-lg shadow-md p-6 mb-6 text-center">
        <div class="text-gray-500">
            <svg class="mx-auto h-12 w-12 text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 1.5M7 13l-1.5 1.5m0 0L5 16h14a2 2 0 002 2H5a2 2 0 01-2-2v0zM9 19v1a2 2 0 002 2h2a2 2 0 002-2v-1" />
            </svg>
            <h3 class="text-lg font-medium text-gray-900 mb-2">Tu carrito está vacío</h3>
            <p class="text-gray-600">Agrega productos a tu carrito para comenzar una compra</p>
        </div>
    </div>


    <div class="bg-white rounded-lg shadow-md p-6 mb-8" id="product-list">
        {{#each products}}
        <div class="border border-gray-200 rounded-lg p-4 mb-4 hover:shadow-md transition-shadow cursor-pointer product-card"
            data-product-id="{{_id}}">
            <div class="flex items-start space-x-4">
                <div class="flex-shrink-0">
                    <img src="{{thumbnail}}" alt="{{title}}" class="w-16 h-16 object-cover rounded-md border">
                </div>
                <div class="flex-grow">
                    <div class="flex justify-between items-start">
                        <div class="flex-grow">
                            <h3 class="font-semibold text-gray-800">{{title}}</h3>
                            <p class="text-sm text-gray-600 mb-2 line-clamp-1">{{description}}</p>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm text-gray-600">
                                <span><strong>Código:</strong> {{code}}</span>
                                <span><strong>Precio:</strong> ${{price}}</span>
                                <span><strong>Stock:</strong> {{stock}}</span>
                                <span><strong>Estado:</strong>
                                    {{#if status}}
                                    <span class="px-2 py-1 rounded text-xs bg-green-100 text-green-800">Activo</span>
                                    {{else}}
                                    <span class="px-2 py-1 rounded text-xs bg-red-100 text-red-800">Inactivo</span>
                                    {{/if}}
                                </span>
                                <span><strong>Categoría:</strong> {{category}}</span>
                                <span><strong>Id:</strong> {{_id}}</span>
                            </div>
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            {{#if status}}
                            {{#if stock}}
                            <button class="add-to-cart-btn bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none 
                                    focus:ring-2 focus:ring-blue-500 text-sm whitespace-nowrap"
                                data-product-id="{{_id}}">
                                Agregar al carrito
                            </button>
                            {{else}}
                            <button disabled
                                class="bg-gray-400 text-white px-4 py-2 rounded-md cursor-not-allowed text-sm whitespace-nowrap">
                                Sin stock
                            </button>
                            {{/if}}
                            {{else}}
                            <button disabled
                                class="bg-gray-400 text-white px-4 py-2 rounded-md cursor-not-allowed text-sm whitespace-nowrap">
                                No disponible
                            </button>
                            {{/if}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {{/each}}

    </div>

    <div class="flex justify-center items-center space-x-4 mb-8">
        {{#if hasPrevPage}}
        <a href="{{prevLink}}"
            class="bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500">
            Anterior
        </a>
        {{else}}
        <button disabled class="bg-gray-400 text-white px-4 py-2 rounded-md cursor-not-allowed">
            Anterior
        </button>
        {{/if}}
        <span class="text-gray-600 font-medium">
            Página {{page}} de {{totalPages}}
        </span>
        {{#if hasNextPage}}
        <a href="{{nextLink}}"
            class="bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500">
            Siguiente
        </a>
        {{else}}
        <button disabled class="bg-gray-400 text-white px-4 py-2 rounded-md cursor-not-allowed">
            Siguiente
        </button>
        {{/if}}
    </div>
</div>

<script src="/js/products.js"></script>